<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
<%@ page contentType="text/html;charset=UTF-8" language="java" %>
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>购物车</title>
	<link type="text/css" rel="stylesheet" href="../../static/css/style.css" >
	<script type="text/javascript" src="../../static/script/jquery-1.7.2.min.js"></script>
</head>
<body>



	<div id="header">
		<img class="logo_img" style=" margin-right:60px;  height: 200px; width: 200px; border-radius: 50%" alt="" src="/FlowerManageSystem/static/img/花店logo.jpg" >
			<span class="wel_word">购物车</span>
		<%@ include file="/pages/common/welcom_common.jsp"%>
	</div>

	<script type="text/javascript">
		$(function () {
			// 给 【删除】绑定单击事件
			$("a.deleteItem").click(function () {
				return confirm("你确定要删除【" + $(this).parent().parent().find("td:first").text() +"】吗?")
			});
			// 给清空购物车绑定单击事件
			$("#clearCart").click(function () {
				return confirm("你确定要清空购物车吗?");
			})
			// 给输入框绑定 onchange内容发生改变事件
			$(".updateCount").change(function () {
				// 获取商品名称
				var name = $(this).parent().parent().find("td:first").text();
				var id = $(this).attr('flowerId');
				// 获取商品数量
				var count = this.value;
				if ( confirm("你确定要将【" + name + "】商品修改数量为：" + count + " 吗?") ) {
					//发起请求。给服务器保存修改
					location.href = "http://localhost:8080/FlowerManageSystem/CartServlet?action=updateCount&count="+count+"&id="+id;
				} else {
					// defaultValue属性是表单项Dom对象的属性。它表示默认的value属性值。
					this.value = this.defaultValue;
				}
			});

		});
	</script>
	
	<div id="main">
	
		<table>
			<tr>
				<td><svg t="1609552716473" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2701" width="30px" height="30px"><path d="M162.133333 776.533333c-17.066667 0-34.133333 12.8-34.133333 34.133334 0 17.066667 17.066667 29.866667 34.133333 34.133333 85.333333 4.266667 170.666667 38.4 230.4 98.133333 12.8 12.8 34.133333 12.8 46.933334 0 12.8-12.8 12.8-34.133333 4.266666-46.933333-72.533333-76.8-174.933333-119.466667-281.6-119.466667z m704-183.466666c72.533333-119.466667 85.333333-264.533333 42.666667-396.8-4.266667-12.8-17.066667-21.333333-29.866667-21.333334h-8.533333c-64 0-123.733333 12.8-183.466667 38.4-29.866667-64-76.8-119.466667-132.266666-162.133333l-4.266667-4.266667c-12.8-4.266667-25.6-4.266667-34.133333 0-4.266667 0-4.266667 4.266667-8.533334 4.266667-55.466667 42.666667-102.4 98.133333-132.266666 162.133333-59.733333-25.6-119.466667-38.4-179.2-34.133333h-12.8c-12.8 0-21.333333 8.533333-29.866667 17.066667-46.933333 132.266667-29.866667 277.333333 42.666667 396.8 55.466667 102.4 157.866667 170.666667 273.066666 187.733333h29.866667v166.4c0 17.066667 17.066667 34.133333 34.133333 34.133333s29.866667-12.8 34.133334-34.133333v-166.4h29.866666c110.933333-17.066667 213.333333-85.333333 268.8-187.733333z m34.133334 183.466666c-106.666667 0-209.066667 46.933333-281.6 119.466667-12.8 12.8-12.8 34.133333 0 46.933333 12.8 12.8 34.133333 12.8 46.933333 0 64-59.733333 145.066667-98.133333 230.4-98.133333 17.066667 0 34.133333-17.066667 34.133333-34.133333 4.266667-21.333333-12.8-34.133333-29.866666-34.133334z" p-id="2702" fill="#FCD1D1"></path></svg></td>
				<td><svg t="1609555763057" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="22595" width="30" height="30"><path d="M770.06848 197.18144C706.49856 169.984 615.6288 156.3648 515.74784 156.3648c-99.88096 0-190.73024 13.63968-254.19776 40.81664-72.6016 31.78496-109.03552 68.07552-109.03552 113.52064v422.2976c0 40.89856 36.31104 81.7152 109.03552 108.99456 63.56992 27.27936 154.4192 40.93952 254.19776 40.93952 99.88096 0 190.75072-13.63968 254.32064-40.93952 68.096-27.25888 109.01504-68.07552 109.01504-109.01504V310.6816c0-45.30176-36.39296-81.7152-109.01504-113.50016z m-40.93952 186.22464c-59.06432 22.77376-140.77952 31.78496-213.4016 31.78496-77.2096 0-154.4192-9.1136-213.4016-31.78496-68.07552-18.16576-99.86048-45.42464-99.86048-72.6016s36.29056-54.45632 99.88096-77.2096c58.96192-22.67136 136.17152-31.80544 213.4016-31.80544 72.6016 0 154.4192 13.63968 213.4016 31.80544 63.5904 22.65088 99.86048 49.95072 99.86048 77.2096 0.1024 27.17696-31.68256 54.45632-99.88096 72.6016z m4.62848 131.6864c-59.0848 18.1248-140.8 31.76448-218.03008 31.76448-77.23008 0-154.43968-13.6192-217.9072-31.76448-63.5904-22.67136-99.88096-49.9712-99.88096-77.2096v-49.9712c45.42464 18.16576 77.2096 40.81664 127.1808 49.9712 59.06432 13.6192 122.63424 22.7328 190.73024 22.7328s131.6864-9.1136 190.73024-22.7328c49.95072-9.13408 81.7152-31.80544 127.16032-49.9712v54.4768c-0.1024 22.75328-36.41344 50.03264-99.98336 72.704z m0 145.28512c-59.0848 18.14528-140.8 31.78496-218.03008 31.78496-77.23008 0-154.43968-13.6192-217.9072-31.78496-63.5904-18.14528-99.88096-45.42464-99.88096-77.2096V515.072c45.42464 22.77376 77.2096 40.93952 127.1808 54.55872 59.06432 13.63968 122.63424 22.67136 190.73024 22.67136s131.6864-9.13408 190.73024-22.67136c49.95072-13.6192 81.7152-31.78496 127.16032-54.55872v68.096c-0.1024 31.78496-36.41344 59.0848-99.98336 77.2096z m-218.0096 177.09056c-77.2096 0-154.43968-13.5168-217.9072-31.78496-63.5904-18.16576-99.88096-45.44512-99.88096-77.2096v-68.096c45.42464 22.65088 77.2096 40.91904 127.16032 54.43584 54.45632 13.63968 122.65472 22.77376 186.12224 22.77376 68.096 0 131.6864-9.13408 190.75072-22.77376 54.55872-13.6192 86.34368-31.78496 131.6864-54.43584v68.07552c0 27.27936-36.31104 54.55872-99.90144 77.2096-59.0848 22.67136-145.3056 31.78496-218.03008 31.78496z" p-id="22596" fill="#FCD1D1"></path></svg></td>
				<td><svg t="1609555875664" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2423" width="30" height="30"><path d="M866.4 575.3v14c0 11.2-2.4 21.7-6 31.8 45.6 22.3 73 49.8 73 79.8 0 73.9-164.9 133.9-368.2 133.9-170.1 0-312.8-42-355.1-99-20.6-6.1-40-13.1-57.7-20.9v119.9c0 117.2 207.7 178.5 412.8 178.5 205.2 0 412.8-61.3 412.8-178.5v-134c-0.1-53.9-44.3-95.8-111.6-125.5zM219.2 880.2c-14.2-14.2-22.3-29.5-22.3-45.5v-48.9c6.8 5.8 14.2 11.4 22.3 16.6v77.8z m66.9 41.7c-17-7.2-32.1-14.9-44.6-23.3v-83.1c13.8 7.3 28.5 14 44.6 20v86.4z m67 22.2c-15.8-4.1-30.8-8.5-44.6-13.5v-87.3c14.2 4.6 29.2 8.7 44.6 12.4v88.4z m66.9 13.7c-15.5-2.4-30.3-5.3-44.6-8.5v-88.4c14.5 3 29.4 5.6 44.6 7.9v89z m67 7.7c-15.3-1.2-30.1-2.8-44.6-4.7v-89.1c14.7 1.8 29.6 3.4 44.6 4.6v89.2z m66.9 2.9c-14.9-0.2-29.8-0.7-44.6-1.5v-89.3c14.8 0.8 29.7 1.3 44.6 1.5v89.3z m67-1.5c-14.6 0.8-29.5 1.3-44.6 1.5v-89.3c14.9-0.2 29.8-0.7 44.6-1.5v89.3z m66.9-6.1c-14.5 1.9-29.3 3.5-44.6 4.7v-89.2c15.1-1.2 29.9-2.7 44.6-4.6v89.1z m67-11.5c-14.3 3.2-29.1 6.1-44.6 8.5v-89c15.2-2.3 30.1-4.9 44.6-7.9v88.4z m66.9-18.7c-13.9 4.9-28.8 9.4-44.6 13.5v-88.3c15.5-3.7 30.4-7.8 44.6-12.4v87.2z m67-32c-12.5 8.4-27.7 16.1-44.6 23.3v-86.4c16.1-6 30.9-12.8 44.6-20v83.1z m44.6-63.9c0 16-8.1 31.3-22.3 45.5v-77.8c8.1-5.3 15.5-10.8 22.3-16.6v48.9zM565.1 9C359.9 9 152.2 70.3 152.2 187.5v133.9c0 117.2 207.7 178.5 412.9 178.5s412.8-61.3 412.8-178.5V187.5C977.9 70.3 770.2 9 565.1 9z m0 44.6c203.3 0 368.2 59.9 368.2 133.9 0 73.9-164.9 133.9-368.2 133.9-203.4 0-368.2-60-368.2-133.9S361.7 53.6 565.1 53.6z m-279 268.7v86.4c-17-7.2-32.1-14.9-44.6-23.3v-83.1c13.8 7.2 28.6 13.9 44.6 20z m22.4 7.8c14.2 4.6 29.2 8.7 44.6 12.4v88.3c-15.8-4.1-30.8-8.5-44.6-13.4v-87.3z m66.9 17.5c14.5 3 29.4 5.6 44.6 7.9v89c-15.5-2.4-30.3-5.3-44.6-8.5v-88.4z m67 10.9c14.7 1.8 29.6 3.4 44.6 4.6v89.2c-15.3-1.2-30.1-2.8-44.6-4.7v-89.1z m66.9 5.9c14.9 0.8 29.7 1.3 44.6 1.5v89.3c-14.9-0.2-29.8-0.7-44.6-1.5v-89.3z m67 1.4c14.9-0.2 29.8-0.7 44.6-1.5v89.3c-14.9 0.8-29.7 1.3-44.6 1.5v-89.3z m66.9-2.8c15.1-1.2 29.9-2.7 44.6-4.6v89.1c-14.5 1.9-29.3 3.5-44.6 4.7V363z m66.9-7.5c15.2-2.3 30.1-4.9 44.6-7.9V436c-14.3 3.2-29.1 6-44.6 8.5v-89z m67-13c15.5-3.7 30.4-7.8 44.6-12.4v87.3c-13.9 4.9-28.8 9.4-44.6 13.4v-88.3z m66.9-20.2c16.1-6 30.9-12.8 44.6-20v83.1c-12.5 8.4-27.7 16.1-44.6 23.3v-86.4z m-647.1-0.9v-48.9c6.8 5.8 14.2 11.4 22.3 16.7V367c-14.2-14.3-22.3-29.6-22.3-45.6zM911 367v-77.8c8.1-5.3 15.5-10.8 22.3-16.7v48.9c0 16-8.1 31.3-22.3 45.6z m0 0" fill="#FCD1D1" p-id="2424"></path><path d="M820.5 464.4c-12.9 69.7-172 124.8-367 124.8-203.3 0-368.2-60-368.2-133.9 0-31.8 30.6-60.9 81.5-83.9-7.7-13-12.4-27-13.6-42-67.9 29.8-112.5 71.8-112.5 125.9v133.9c0 117.2 207.7 178.5 412.8 178.5 205.2 0 412.8-61.3 412.8-178.5V455.3c0-2.7-0.7-5.3-0.9-8-14.1 6.2-29 12-44.9 17.1zM107.6 634.7c-14.2-14.2-22.3-29.5-22.3-45.5v-48.9c6.8 5.8 14.2 11.4 22.3 16.6v77.8z m67 41.8c-17-7.2-32.1-14.9-44.6-23.3V570c13.8 7.3 28.5 14 44.6 20v86.5z m66.9 22.1c-15.8-4.1-30.8-8.5-44.6-13.4v-87.3c14.2 4.6 29.2 8.7 44.6 12.4v88.3z m67 13.7c-15.5-2.4-30.3-5.3-44.6-8.5v-88.4c14.5 3 29.4 5.6 44.6 7.9v89z m66.9 7.7c-15.3-1.2-30.1-2.8-44.6-4.7v-89.1c14.7 1.8 29.6 3.4 44.6 4.6V720z m67 2.9c-14.9-0.2-29.8-0.7-44.6-1.5v-89.3c14.8 0.8 29.7 1.3 44.6 1.5v89.3z m66.9-1.5c-14.9 0.8-29.7 1.3-44.6 1.5v-89.3c14.9-0.2 29.8-0.7 44.6-1.5v89.3z m67-6.1c-14.5 1.9-29.3 3.5-44.6 4.7v-89.2c15.1-1.2 29.9-2.7 44.6-4.6v89.1z m66.9-11.5c-14.3 3.2-29.1 6.1-44.6 8.5v-89c15.2-2.3 30.1-4.9 44.6-7.9v88.4z m66.9-18.7c-13.9 4.9-28.8 9.4-44.6 13.4v-88.3c15.5-3.7 30.4-7.8 44.6-12.4v87.3z m67-32c-12.5 8.4-27.7 16.1-44.6 23.3V590c16.1-6 30.9-12.7 44.6-20v83.1z m44.6-63.9c0 16-8.1 31.3-22.3 45.5V557c8.1-5.3 15.5-10.8 22.3-16.6v48.8z m0 0" fill="#FCD1D1" p-id="2425"></path></svg></td>
				<td><svg t="1609555893929" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3275" width="30" height="30"><path d="M643.423939 473.402864a23.932991 23.932991 0 0 1-24.071332 23.517968 23.656309 23.656309 0 0 1-23.379627-23.517968A24.486355 24.486355 0 0 0 588.087544 456.525263a24.763037 24.763037 0 0 0-17.569306-7.332072h-117.036476A25.731424 25.731424 0 0 0 435.912456 456.525263a25.454742 25.454742 0 0 0-6.917049 17.292624v76.779249A25.731424 25.731424 0 0 0 435.912456 567.198055a26.838152 26.838152 0 0 0 17.292624 7.05539h119.526614a74.012429 74.012429 0 0 1 48.557687 21.304512 72.075655 72.075655 0 0 1 22.134558 51.047825v77.055931A72.76736 72.76736 0 0 1 621.566063 774.709538a74.427452 74.427452 0 0 1-50.771143 21.166171h-35.138611V816.211835a23.517968 23.517968 0 0 1-46.897595 0v-20.612808h-35.276952a72.490678 72.490678 0 0 1-71.798974-72.075655 23.656309 23.656309 0 0 1 23.794651-23.517968 23.379627 23.379627 0 0 1 23.517968 23.517968 25.039719 25.039719 0 0 0 6.917049 17.430965 25.869765 25.869765 0 0 0 17.292624 7.332072h117.313158a25.869765 25.869765 0 0 0 17.569306-7.332072 25.039719 25.039719 0 0 0 7.332072-17.292624v-77.055931A25.593083 25.593083 0 0 0 588.087544 629.4515a24.071332 24.071332 0 0 0-17.569306-6.91705h-119.526614a69.170494 69.170494 0 0 1-48.281005-21.304512 72.075655 72.075655 0 0 1-21.166172-50.494461v-77.332613a72.490678 72.490678 0 0 1 71.937315-72.213996h35.138611v-20.197785a23.517968 23.517968 0 1 1 46.897595 0V401.188868h34.861929A71.937314 71.937314 0 0 1 643.423939 473.402864zM512.138341 1023.723318H87.846528A39.565523 39.565523 0 0 1 48.557687 984.434477a41.502297 41.502297 0 0 1 9.960551-26.56147 333.401783 333.401783 0 0 0 49.941097-101.957309A410.596055 410.596055 0 0 0 131.56228 733.207241V547.691975A374.489057 374.489057 0 0 1 160.198865 401.188868a369.37044 369.37044 0 0 1 83.004594-123.400162 364.528506 364.528506 0 0 1 123.400162-83.004594 357.473115 357.473115 0 0 1 66.542015-20.059443L325.239665 67.648744a39.565523 39.565523 0 0 1 0-55.336396A40.118887 40.118887 0 0 1 352.907863 0h318.184274a39.703864 39.703864 0 0 1 39.427182 39.703864 39.012159 39.012159 0 0 1-11.482302 27.668198l-108.044312 107.76763A350.832748 350.832748 0 0 1 657.258038 195.475817a368.817076 368.817076 0 0 1 123.815185 83.004594A377.255877 377.255877 0 0 1 892.43772 547.691975V733.207241a418.758173 418.758173 0 0 0 22.41124 122.846798 355.951364 355.951364 0 0 0 51.047825 103.894083 38.873818 38.873818 0 0 1-5.810322 55.336396 41.502297 41.502297 0 0 1-24.624696 8.715482zM157.432045 945.145636h709.13591a470.359362 470.359362 0 0 1-26.008106-65.020264A492.632262 492.632262 0 0 1 814.413402 733.207241V547.691975a301.860038 301.860038 0 0 0-88.814915-213.875169 291.346123 291.346123 0 0 0-97.807079-65.711969 298.124831 298.124831 0 0 0-115.099703-21.719536h-1.106728a301.168333 301.168333 0 0 0-115.376385 21.719536 290.516077 290.516077 0 0 0-96.838692 65.711969 315.140773 315.140773 0 0 0-66.542016 98.222102 305.318563 305.318563 0 0 0-22.687922 115.653067V733.207241a500.932721 500.932721 0 0 1-26.423129 146.77979 553.363956 553.363956 0 0 1-26.284788 65.020264z m-98.913807 12.865712a41.502297 41.502297 0 0 1 29.32829-12.865712l-29.32829 12.865712zM447.948122 78.716023l64.190219 63.913537 63.913537-63.913537z" fill="#FCD1D1" p-id="3276"></path></svg></td>
				<td><svg t="1609553782103" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="10133" width="30" height="30"><path d="M816.98 738.571a30 30 0 0 1 0.007-1.39c0.009-0.317 0.013-0.636 0.013-0.956V531.649c0-18.081-14.658-32.739-32.74-32.739-18.08 0-32.738 14.658-32.738 32.74h-60v-63.056c0-18.081-14.658-32.739-32.74-32.739-15.846 0-29.354 11.357-32.192 26.72-6.63 35.897-59.5 31.056-59.5-5.449v-35.823c0-18.081-14.658-32.74-32.74-32.74-17.215 0-31.468 13.348-32.657 30.397-2.689 38.538-59.928 36.543-59.928-2.087V255.064c0-16.052-13.012-29.064-29.064-29.064s-29.064 13.012-29.064 29.064v368.712c0 26.97-32.817 40.243-51.565 20.855l-73.745-76.255c-11.019-11.394-29.184-11.711-40.594-0.709l-0.03 0.029c-11.338 10.965-11.641 29.047-0.675 40.386l110.151 113.903a30 30 0 0 1 2.686 3.194c0.907 1.246 2.056 2.556 3.473 3.923 14.214 13.72 24.89 25.306 47.22 50.539l0.738 0.833c20.863 23.576 30.485 34.041 42.82 46.04 15.747 15.319 30.83 27.537 46.893 37.603C508.76 887.772 553.056 900 611.455 900c75.809 0 129.362-16.966 162.52-47.48C802.764 826.028 817 788.244 817 740.835c0-0.756-0.007-1.51-0.02-2.264z m60.02 2.264c0 63.19-20.319 117.114-62.395 155.835C769.195 938.459 701.2 960 611.455 960c-69.458 0-124.814-15.28-172.306-45.041-19.945-12.499-38.266-27.339-56.871-45.438-13.756-13.382-24.07-24.598-45.914-49.284l-0.738-0.834c-21.3-24.069-31.242-34.857-43.958-47.13-3.279-3.166-6.253-6.47-8.91-9.913l-108.86-112.568c-34.003-35.16-33.064-91.225 2.095-125.227l0.091-0.088c35.24-33.981 91.342-33.002 125.374 2.188l22.179 22.935V255.064c0-49.189 39.875-89.064 89.064-89.064 49.189 0 89.064 39.875 89.064 89.064v79.392c10.151-3.811 21.136-5.892 32.585-5.892 38.166 0 70.947 23.055 85.177 55.997 11.967-5.598 25.288-8.706 39.256-8.706 43.41 0 79.853 29.825 89.956 70.101 10.94-4.54 22.939-7.046 35.522-7.046 51.218 0 92.739 41.52 92.739 92.74v204.575c0 0.64-0.007 1.28-0.02 1.918 0.013 0.897 0.02 1.794 0.02 2.692z" p-id="10134" fill="#FCD1D1"></path><path d="M639 274.5c0 16.569-13.431 30-30 30-16.569 0-30-13.431-30-30 0-83.671-67.829-151.5-151.5-151.5S276 190.829 276 274.5c0 21.627 4.516 42.562 13.14 61.827 6.77 15.123 0 32.87-15.122 39.64-15.123 6.77-32.87-0.001-39.64-15.123C222.318 333.904 216 304.619 216 274.5 216 157.692 310.692 63 427.5 63S639 157.692 639 274.5z" p-id="10135" fill="#FCD1D1"></path></svg></td>
			</tr>

			<c:if test="${empty sessionScope.cart.items}">
				<tr>
					<td colspan="5">当前购物车为空<a style="color: #FCD1D1" href="/FlowerManageSystem/ClientServlet?method=page">去首页</a></td>
				</tr>
			</c:if>

			<c:if test="${not empty sessionScope.cart.items}">
				<c:forEach items="${sessionScope.cart.items}" var="entry">
					<tr>
						<td>${entry.value.tradeName}</td>
						<td>
							<input class="updateCount" type="text" style="width: 70px;text-align: center"
								   flowerId="${entry.value.id}"
								   value="${entry.value.tradeCount}">
						</td>
						<td>${entry.value.tradePrice}</td>
						<td>${entry.value.tradeTotalPrice}</td>
						<td><a style="color: #FCD1D1" class="deleteItem" href="/FlowerManageSystem/CartServlet?action=deleteItem&id=${entry.value.id}">删除</a></td>
					</tr>
				</c:forEach>
			</c:if>


			
		</table>
		
		<c:if test="${not empty sessionScope.cart.items}">
			<div class="cart_info">
				<span class="cart_span">购物车中共有<span class="b_count">${sessionScope.cart.totalCount}</span>件商品</span>
				<span class="cart_span">总金额<span class="b_price">${sessionScope.cart.totalPrice}</span>元</span>
				<span class="cart_span"><a style="color: #FCD1D1" id="clearCart" href="/FlowerManageSystem/CartServlet?action=clearItem">清空购物车</a></span>
				<span class="cart_span"><a style="color: #FCD1D1" href="/FlowerManageSystem/OrderServlet?action=createOrder">去结账</a></span>
			</div>
		</c:if>
		
	
	</div>
	
	<%@ include file="/pages/common/foot.jsp"%>
</body>
</html>